{% extends _layout %}

{% block content %}
    <p><a href="/balances">&larr; Все счета</a></p>
    <h1><a href="/balances/show?id={{ balance.id }}">{{ balance.name }}</a></h1>
    <p>Баланс: <b>{{ balance.amount }}</b><br>Тип счета: {{ balanceTypes[balance.type] }}</p>
    {% if(message) %}
        <div class="ui success message">
            {{ message }}
        </div>
        <p></p>
    {% endif %}

    <h2>Добавить внесение</h2>
    <div class="ui form">
        <form action="/balances/addTransaction" method="post">
            <input type="hidden" name="balance_to_id" value="{{ balance.id }}"/>
            <div class="field">
                <label>В связи с чем?</label>
                <input type="text" name="description" placeholder="Описание" value="{{ bind.description }}"/>
            </div>
            <div class="field">
                <label>Сколько?</label>
                <input type="text" name="amount" placeholder="Количество" value="{{ bind.amount }}"/>
            </div>
            {#<div class="field">#}
                {#<label>Когда?</label>#}
                {#<input type="date" name="date" placeholder="Дата" value="{{ bind.date }}"/>#}
            {#</div>#}
            <div class="field">
                <label for="type">Со счета</label>
                <select name="balance_from_id" id="type" class="ui dropdown search">
                    <option value="">Из космоса</option>
                    {% for globalBalance  in allBalances %}
                        {% if(globalBalance.id != balance.id) %}
                        <option value="{{ globalBalance.id }}">{{ globalBalance.name }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <button class="ui button" type="submit">Добавить</button>
        </form>
    </div>

    <h2>Транзакции</h2>
    <div class="ui cards">
        {% for transaction in transactions %}
            <div class="card">
                <div class="content">
                    <div class="header">{{ transaction.description }}</div>
                    <div class="meta">
                        {% if (transaction.balance_from) %}
                            <a href="/balances/show?id={{ transaction.balance_from }}" style="margin: 0">{{ allBalances[transaction.balance_from].name }}</a>
                        {% endif %}
                        &rarr;
                        <a href="/balances/show?id={{ transaction.balance_to }}">{{ allBalances[transaction.balance_to].name }}</a>
                    </div>
                    <div class="description ">
                        <b>{{ transaction.amount | number_format(2, '.', ' ') }}</b>
                    </div>
                </div>
                <div class="extra content">
                    <div class="description">
                        {{ transaction.created_date | date('d.m.Y H:i') }}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

{% endblock %}